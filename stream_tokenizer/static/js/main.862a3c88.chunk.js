(this["webpackJsonptorus-solana-example"]=this["webpackJsonptorus-solana-example"]||[]).push([[0],{127:function(e,t,n){},210:function(e,t){},231:function(e,t,n){},239:function(e,t){},248:function(e,t){},256:function(e,t){},263:function(e,t){},264:function(e,t){},283:function(e,t){},285:function(e,t){},296:function(e,t){},298:function(e,t){},324:function(e,t){},326:function(e,t){},332:function(e,t){},344:function(e,t){},347:function(e,t){},36:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return j})),n.d(t,"a",(function(){return w})),n.d(t,"f",(function(){return O})),n.d(t,"c",(function(){return y}));var r,a=n(1),c=n.n(a),o=n(5),i=n(23),s=n(43),u=n.n(s),l=Object(i.g)("devnet"),p=new i.c("ugSaSJkZZ2HjfrZguYUxJRT78bs7TFPbj2vg47RYvVk"),f=new i.c("SysvarC1ock11111111111111111111111111111111"),b=u.a.struct([u.a.u32("numGreets"),u.a.s32("flow"),u.a.nu64("timestamp")]),g=b.span;function d(){return m.apply(this,arguments)}function m(){return(m=Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new i.b(l,"singleGossip"),e.next=3,r.getVersion();case 3:t=e.sent,console.log("Connection to cluster established:",l,t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return h.apply(this,arguments)}function h(){return(h=Object(o.a)(c.a.mark((function t(n){var a,o,i,s,u;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.getAccountInfo(n);case 2:if(null!==(a=t.sent)){t.next=5;break}throw"Error: cannot find the greeted account";case 5:return console.log("Raw account info",a.data),o=b.decode(e.from(a.data)),i=Number(o.numGreets.toString()),s=Number(o.flow.toString()),u=Number(o.timestamp.toString()),console.log("Static balance",i),console.log("Flow",s),console.log("Last time(saved)",u),t.abrupt("return",{staticBal:i,flow:s,lastTranTime:u});case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function w(e,t){return x.apply(this,arguments)}function x(){return(x=Object(o.a)(c.a.mark((function t(n,a){var o,s,l,b,g;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Adding balance to",n.toBase58()),o=u.a.struct([u.a.u8("instruction")]),s=e.alloc(1024),l=o.encode({instruction:1},s),s=s.slice(0,l),b=new i.f({keys:[{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0}],programId:p,data:s}),t.next=8,Object(i.h)(r,(new i.e).add(b),[a],{commitment:"singleGossip",preflightCommitment:"singleGossip"});case 8:g=t.sent,console.log("Response",g),window.location.reload(!1);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(e,t,n,r){return v.apply(this,arguments)}function v(){return(v=Object(o.a)(c.a.mark((function t(n,a,o,s){var l,b,g,d,m;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Creating flow from",a.toBase58(),"to",o.toBase58()),l=u.a.struct([u.a.u8("instruction"),u.a.u8("flow")]),b=e.alloc(1024),g=l.encode({instruction:2,flow:n},b),b=b.slice(0,g),d=new i.f({keys:[{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0}],programId:p,data:b}),t.next=8,Object(i.h)(r,(new i.e).add(d),[s],{commitment:"singleGossip",preflightCommitment:"singleGossip"});case 8:m=t.sent,console.log("Response",m),window.location.reload(!1);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function y(e){return k.apply(this,arguments)}function k(){return(k=Object(o.a)(c.a.mark((function e(t){var n,a,o,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new i.a,a=n.publicKey,console.log("Creating sender account",a.toBase58()),e.next=5,r.getMinimumBalanceForRentExemption(b.span);case 5:return o=e.sent,s=(new i.e).add(i.d.createAccount({fromPubkey:t.publicKey,newAccountPubkey:a,lamports:o,space:g,programId:p})),e.next=9,Object(i.h)(r,s,[t,n],{commitment:"singleGossip",preflightCommitment:"singleGossip"});case 9:return u=e.sent,console.log("Create account transaction ID",u),e.abrupt("return",a);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}).call(this,n(17).Buffer)},367:function(e,t){},386:function(e,t){},388:function(e,t){},404:function(e,t){},405:function(e,t){},408:function(e,t){},438:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),c=n(67),o=n.n(c),i=(n(231),n(35)),s=(n(127),n(1)),u=n.n(s),l=n(5),p=n(208),f=n.n(p),b=n(51),g=n.n(b),d=n(458),m=n(460),j=n(462),h=n(463);function w(e){return new Uint8Array(e.match(/.{1,2}/g).map((function(e){return parseInt(e,16)})))}var x=n.p+"static/media/brandIcon.ac21c50e.svg",O=n(15),v=Object(d.a)((function(e){return{loginButton:{marginTop:e.spacing(5)},icon:{maxHeight:e.spacing(7)}}}));var y=function(e){var t=e.setPrivateKey,n=v(),a=Object(r.useState)(),c=Object(i.a)(a,2),o=c[0],s=c[1];function p(){return(p=Object(l.a)(u.a.mark((function e(){var n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Torus",o),e.next=3,o.triggerLogin({typeOfLogin:"google",clientId:"200932224620-4klf8kflcdqic8t1dptivlj55gds2ml0.apps.googleusercontent.com",verifier:"solana-streaming-token"});case 3:n=e.sent,r=g.a.sign.keyPair.fromSeed(w(n.privateKey.padStart(64))).secretKey,a=""+r,console.log("Stringified key",a),window.localStorage.setItem("privateKey",a),t(a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(h.a)(),Object(r.useEffect)((function(){function e(){return(e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new f.a({baseUrl:"".concat(window.location.origin,"/serviceworker"),network:"testnet",enableLogging:!0}),e.next=3,t.init({skipSw:!1});case 3:s(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(O.jsx)("div",{className:"App",children:o&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("img",{src:x,className:n.icon}),Object(O.jsx)(m.a,{variant:"h4",children:"SolarStream"}),Object(O.jsx)(m.a,{variant:"h6",children:"Streamable tokens on Solana"}),Object(O.jsx)(j.a,{variant:"contained",color:"primary",onClick:function(){return p.apply(this,arguments)},className:n.loginButton,children:"Login with Google"})]})})},k=n(23),S=n(461),B=n(36),C=Object(d.a)((function(e){return{root:{flexGrow:1},paper:{height:140,width:100},control:{padding:e.spacing(2)},balances:{margin:e.spacing(10)},address:{marginTop:e.spacing(1)},flowButton:{margin:e.spacing(2)},flowButtonGroup:{marginTop:e.spacing(1)},tokenCount:{marginTop:e.spacing(2)},airdropButton:{marginTop:e.spacing(1)}}}));function N(e){var t=e.privateKey,n=C(),a=t.split(",").map((function(e){return Number(e)})),c=new k.a(a),o=Object(r.useState)(),s=Object(i.a)(o,2),p=s[0],f=s[1],b=Object(r.useState)(),g=Object(i.a)(b,2),d=g[0],h=g[1],w=Object(r.useState)(0),x=Object(i.a)(w,2),v=x[0],y=x[1],N=Object(r.useState)(0),I=Object(i.a)(N,2),G=I[0],K=I[1];function T(e,t){return A.apply(this,arguments)}function A(){return(A=Object(l.a)(u.a.mark((function e(t,n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Settig public key for",t),!(r=window.localStorage.getItem(t))){e.next=7;break}console.log("Stored",t,":",r),n(new k.c(r)),e.next=13;break;case 7:return console.log("No account found, creating new"),e.next=10,Object(B.c)(c);case 10:a=e.sent,window.localStorage.setItem(t,a.toBase58()),n(a);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return(F=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p||!d){e.next=3;break}return e.next=3,Object(B.f)(1,p,d,c);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return(L=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p||!d){e.next=3;break}return e.next=3,Object(B.f)(0,p,d,c);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=Object(l.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.b.getBalance(c.publicKey);case 2:if(t=e.sent,console.log("Lamport balance",t),!(t<(n=1e8))){e.next=10;break}return e.next=8,B.b.requestAirdrop(c.publicKey,n);case 8:r=e.sent,console.log("Airdrop response",r);case 10:T("senderKey",f),T("receiverKey",h);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t){return R.apply(this,arguments)}function R(){return(R=Object(l.a)(u.a.mark((function e(t,n){var r,a,c,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=11;break}return e.next=3,Object(B.e)(n);case 3:return r=e.sent,a=r.staticBal,c=r.flow,o=r.lastTranTime,i=setInterval((function(){var e=0;o&&(e=Math.floor(Date.now()/1e3)-o);t(a+e*c)}),1e3),e.abrupt("return",(function(){return clearInterval(i)}));case 11:console.log("Account not yet set");case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return(W=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p){e.next=3;break}return e.next=3,Object(B.a)(p,c);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){Object(B.d)(),function(){P.apply(this,arguments)}()}),[]),Object(r.useEffect)((function(){console.log("Getting sender balance"),E(y,p)}),[p]),Object(r.useEffect)((function(){console.log("Getting receiver balance"),E(K,d)}),[d]),Object(O.jsxs)(S.a,{container:!0,justify:"center",className:n.root,spacing:1,children:[Object(O.jsx)(S.a,{item:!0,xs:12,className:n.address,children:Object(O.jsxs)(m.a,{variant:"subtitle1",children:["Account: ",c.publicKey.toBase58()]})}),Object(O.jsx)(S.a,{item:!0,xs:12,className:n.balances,children:Object(O.jsxs)(S.a,{container:!0,justify:"center",spacing:10,children:[Object(O.jsxs)(S.a,{item:!0,xs:4,children:[Object(O.jsx)(m.a,{variant:"h4",children:"Sender"}),Object(O.jsxs)(m.a,{variant:"h5",className:n.tokenCount,children:[v," coins"]}),Object(O.jsx)(j.a,{variant:"outlined",color:"primary",className:n.airdropButton,onClick:function(){return W.apply(this,arguments)},children:"+50 Airdrop"})]}),Object(O.jsxs)(S.a,{item:!0,xs:4,children:[Object(O.jsx)(m.a,{variant:"h4",children:"Receiver"}),Object(O.jsxs)(m.a,{variant:"h5",className:n.tokenCount,children:[G," coins"]})]})]})}),Object(O.jsxs)(S.a,{item:!0,xs:12,className:n.flowButtonGroup,children:[Object(O.jsx)(j.a,{variant:"contained",color:"primary",className:n.flowButton,onClick:function(){return F.apply(this,arguments)},children:"Flow"}),Object(O.jsx)(j.a,{variant:"contained",color:"secondary",className:n.flowButton,onClick:function(){return L.apply(this,arguments)},children:"Stop"})]})]})}function I(){var e=Object(r.useState)(window.localStorage.getItem("privateKey")),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(O.jsx)(r.Fragment,{children:n?Object(O.jsx)(N,{privateKey:n}):Object(O.jsx)(y,{setPrivateKey:a})})}var G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,465)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};o.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(I,{})}),document.getElementById("root")),G()}},[[438,1,2]]]);
//# sourceMappingURL=main.862a3c88.chunk.js.map